\chapter{多重线性代数}
本章介绍之后的笔记中需要用到的代数内容.
我们的讨论比较偏向代数本身, 如果读者只关心代数工具在几何上的应用的话, 不妨跳过一些证明, 尤其是有许多交换图的那些.

本章中所有的环都有单位元.

\section{模与对偶空间}

\subsection*{模的定义与简单性质}

\begin{defn}\label{def of left module}
    一个环$R$上的\textbf{左模}由一个Abel群$M$与$R$到$M$的自同态群的一个同态构成.
    换言之, 任意一个$r\in R$都诱导了一个$M\to M$的映射, 对$m\in M$, $m$在$r$诱导的映射下的像记为$rm$.
    我们要求这些映射满足如下公理:
    \begin{enumerate}
        \item 对$r\in R$, $m,n\in M$有$r(m+n)=rm+rn$;
        \item 对$r,s\in R$, $m\in M$有$(r+s)m=rm+sm$;
        \item 对$r,s\in R$, $m\in M$有$(rs)m=r(sm)$;
        \item 对任意$m\in M$有$1m=m$.
    \end{enumerate}
\end{defn}

\begin{defn}
    一个环$R$上的\textbf{右模}由一个Abel群$M$与$R$到$M$的自同态群的一个反同态构成.
    即将定义~\ref{def of left module}~中的公理3变为$(rs)m=s(rm)$.
\end{defn}

\begin{rem}
    如果$R$是交换的, 那么左模和右模是一样的, 称为\textbf{双侧模}或者直接简称为\textbf{模}.
    此外, 我们也可以把右模的像写成$mr$, 那么``数乘的结合公理''\footnote{打引号是因为我们只对向量空间说数乘, 模一般说作用.}可以写成很好看的形式$m(sr)=(ms)r$.
    我们接下来基本不会遇到非交换环上的模, 所以我们不再区分左右模.
    如果环给定了, 有时我们也不会特别指明环.
\end{rem}

类似于向量空间之间的同态, 我们也有模之间的同态:
\begin{defn}
    设$M,N$是$R$上的模, $f$是$M\to N$的Abel群同态, 如果$f$满足对任意$r\in R$与$m\in M$有$rf(m)=f(rm)$, 那么称$f$是$M$到$N$的一个\textbf{$R$-同态}.
    如果一个$R$-同态是一个双射, 那么就将其称为是一个\textbf{$R$-同构}.
    如果两个模$M,N$之间存在一个同构$f:M\to N$, 那么就称他们是\textbf{同构}的, 并记作$M\cong N$.
    一个模到自身的同构叫做\textbf{自同构}.
\end{defn}

\begin{sym}
    $M$到$N$间的全体$R$-同态的集合记为$\Hom_R(M,N)$, 当$M=N$时$\Hom_R(M,N):=\End_RM$.
    $M$到自身的全体$R$-自同构的集合记为$\Aut_RM$.
\end{sym}

\begin{eg}
    模与向量空间有许多类似的性质.
    例如对于任意$r\in R$与$0\in M$有
    \begin{align*}
        r0 & =  r(0+0) \quad \text{(Abel群公理)}\\
        r0 & =  r0+r0 \quad \text{(第1条模公理)}\\
        \implies 0 & =  r0 \quad \text{(Abel群消去律)}
    \end{align*}
    也就是说有$r0=0$.
    同理也有对任意$m\in M$有$0m=0$.
    但与向量空间不同的是, 在模上$ra=0$并不能推出$a=0$.
    例如所有Abel群都是$\mathbb{Z}$-模 (作用方式为$na=\underbrace{a+\cdots+a}_{n\text{次}}$), 那么对有限Abel群$G$来说,
    Lagrange定理保证了对任意$g\in G$都有$|G|g=0$, 而$g$不一定是$0$.

    对模的同态$f\in\Hom_R(M,N)$, 我们也类似线性映射定义
    \begin{gather*}
        \ker{f}:=\{m\in M|\ f(m)=0\}\\
        \im{f}:=\{n\in N|\ \exists m\in M: f(m)=n\}
    \end{gather*}
    与线性映射相同, 我们仍有 ``$f$是单射当且仅当$\ker{f}=0$'' 与 ``$f$是满射当且仅当$\im{f}=N$'' 这两条命题成立.
\end{eg}

子模的定义是自然的:
\begin{defn}\label{def of submodule}
    设$M$是$R$上的模, 如果$N\subset M$关于加法是$M$的子群, 并且对任意$r\in R, n\in N$有$rn\in N$, 那么称$N$是$M$的一个\textbf{子模}.
\end{defn}

对子模而言, 我们会考虑子模上的商结构.
$N$是Abel加群$M$的子群, 所以存在一个商群$M/N$.
但$M/N$上有更多的代数结构:
\begin{prop}\label{quotient module}
    记号承定义~\ref{def of submodule}, $M/N$有自然的$R$-模结构.
    即$M/N$是$R$-模且有自然$R$-同态$\pi:M\to M/N$, 自然性体现为$\pi$满足\textbf{泛性质}:
    如果模同态$f:M\to P$满足$N\subset\ker{f}$, 那么存在唯一的$\overline{f}:N\to P$使得下图交换
    \[\begin{tikzcd}
        M \arrow[r, "f"] \arrow[d, "\pi"'] & P \\
        N \arrow[ur, dashed, "\overline{f}"'] &
    \end{tikzcd}\]
\end{prop}
\begin{proof}
    设$\pi$是商群的自然同态.
    对$\overline{n}\in M/N$, 如果$\pi(n)=\overline{n}$, 定义$r\overline{n}=\pi(rn)$.
    我们验证良定义性: 设$\pi(m)=\pi(n)$, 那么一定有
    \begin{align*}
        r\pi(m)-r\pi(n)&=\pi(rm)-\pi(rn)\\
        &=r\pi(m-n)\\
        &=r0\\
        &=0
    \end{align*}
    容易验证这样定义的作用满足模的公理, 所以$M/N$是一个模, 并且由作用的定义立刻知道$\pi:M\to M/N$是$R$-同态.
    以下验证泛性质: 设$f:M\to P$满足$N\subset\ker{f}$, 定义
    \[\overline{f}(\overline{m})=f(m)\]
    如果$\pi(m)=\pi(n)$, 那么有$m-n\in\ker{f}$, 则
    \begin{align*}
        \overline{f}(\pi(m))-\overline{f}(\pi(n))&=f(m)-f(n)\\
        &=f(m-n)\\
        &=0
    \end{align*}
    所以$\overline{f}$是良定义的.
    如果另外存在一个同态$g$满足要求, 那么一定有
    \[g(\overline{m})=f(m)=\overline{f}(\overline{m})\]
    对任意$\overline m\in M/N$成立.
    所以$g=\overline{f}$, 即$\overline{f}$是唯一的.
\end{proof}

这是我们遇到的第一个泛性质, 之后我们还会遇到很多次.

\subsection*{对偶模与对偶空间}

\begin{prop}
    对$R$-模$M$, $\Hom_R(M,R)$构成一个$R$-模, 称作$M$的\textbf{对偶模}.
\end{prop}
\begin{proof}
    对$f,g\in\Hom_R(M,R)$, 定义
    \begin{gather*}
        (f+g)(m)=f(m)+g(m)\\
        (-f)(m)=-f(m)
    \end{gather*}
    那么这样定义的加法使得$\Hom_R(M,R)$成为Abel群;
    对$r\in R$, 定义
    \[(rf)(m)=rf(m)\]
    容易验证这样定义的作用满足模公理, 从而使得$\Hom_R(M,R)$成为一个模.
\end{proof}

\begin{sym}
    当$V$是域$k$上的向量空间时, 习惯上把$\Hom_k(V,k)$记作$V^*$, 并称为\textbf{对偶空间}.
\end{sym}

研究对偶模 (确切地说是\textit{反变函子}$\Hom_R(\quad,R)$) 的性质需要深入的代数讨论, 在微分几何中我们更关心对偶空间的性质.
以下我们主要讨论有限维向量空间的对偶空间.

有限维对偶空间的一个基本性质是
\begin{prop}\label{dim of dual space}
    $\dim V=\dim V^*<\infty$.
\end{prop}
\begin{proof}
    取$V$的一组基$(e_1,\cdots,e_n)$, 我们定义$V^*$的\textbf{对偶基}$(\theta^1,\cdots,\theta^n)$为:
    \[\theta^i(e_j)=\delta_{ij}=\begin{cases}
        1, & i=j\\
        0, & i\neq j
    \end{cases}\]
    首先我们验证$\{\theta^1,\cdots,\theta^n\}$线性无关.
    如果存在$c_i\in k(i=1,\cdots,n)$使得
    \begin{equation}
        \sum_ic_i\theta^i=0\label{independence of dual basis}
    \end{equation}
    那么将~\eqref{independence of dual basis}~两端作用在$e_j$上, 可以得到$c_j=0$.
    由$j$的任意性可知$\{\theta^1,\cdots,\theta^n\}$线性无关.
    其次, 对任意$v^*\in V^*$, 考虑
    \begin{equation}
        \sum_{i}v^*(e_i)\theta^i\in V^*\label{element in dual space}
    \end{equation}
    \eqref{element in dual space}~与$v^*$对$(e_1,\cdots,e_n)$中每个元素的作用都是一样的, 那么它们作为线性映射是相等的,
    从而$v^*$可以被$(\theta^1,\cdots,\theta^n)$线性表示.
    因此$(\theta^1,\cdots,\theta^n)$是$V^*$的一组基.
\end{proof}

对偶也可以应用在线性映射上:
\begin{defn}
    对$f\in\Hom_k(V,W)$, 定义它的\textbf{对偶映射}为
    \begin{align*}
        f^*:W^*&\to V^*\\
        w^*&\mapsto w^*\circ f
    \end{align*}
\end{defn}
注意到对偶映射把箭头反了过来.
对偶映射还有一个有趣的性质:
\begin{prop}
    设$f\in\Hom_k(V,W)$在$V,W$各自的一组基下的矩阵为$A$, 那么$f^*$在这两组基的对偶基下的矩阵为$A^\top$.
\end{prop}
\begin{proof}
    对任意一个$w^*\in W$, 设它在$W$的对偶基下的坐标为列向量$Q$.
    那么由~\eqref{element in dual space}~式可知, 它作为一个线性映射在$W$的基下的矩阵为$Q^\top$.
    因此$w^*$在$f$作用下的像在$V$的基下的矩阵为$Q^\top A$, 那么$f^*(w^*)$在$V$的对偶基下的坐标为$A^\top Q$.
    从而$f^*$在对应对偶基下的矩阵为$A^\top$.
\end{proof}

命题~\ref{dim of dual space}~保证了$V$与$V^*$总是同构的, 但这个同构并不是\textit{自然}的:
``自然''意味着这个同构应当不依赖于基的选取, 或者后面我们也会给它另一个严格的定义.
再次应用命题~\ref{dim of dual space}~可以知道$V$和$V^{**}$也是同构的, 此时它们之间存在自然的同构映射了.

\begin{prop}
    任意一个有限维向量空间$V$与它对偶空间的对偶空间$V^{**}$\textbf{自然地}同构.
    具体而言, 对任意$V$, 存在同构$\iota_V:V\to V^{**}$, 满足对任意$f\in\Hom_k(V,W)$有图表
    \begin{equation}
        \begin{tikzcd}
            V\arrow[r, "f"] \arrow[d, "\iota_V"'] & W \arrow[d, "\iota_W"]\\
            V^{**} \arrow[r, "f^{**}"] & W^{**}
        \end{tikzcd}\label{naturality of double dual}
    \end{equation}
    交换.
\end{prop}
\begin{proof}
    我们定义
    \begin{align*}
        \iota_V(v):V^*&\to k\\
        a^*&\mapsto a^*(v)
    \end{align*}
    我们证明这是一个同构.
    设$v\in\ker\iota_V$, 那么对任意$a^*\in V^*$都有$a^*(v)=0$.
    如果$v\neq 0$, 定义
    \[b^*(w)=\begin{cases}
        l, & w=lv\\
        0, & \text{其他}
    \end{cases}\]
    容易验证$b^*\in V^*$, 从而产生矛盾, 一定有$v=0$.
    因此$\iota_V$是单射, 结合$\dim V=\dim V^*$可知$\iota_V$是同构.
    我们接下来证明映射族$\{\iota_V\}_{V\in\mathsf{finVect}_k}$的自然性\footnote{自然性来自范畴论, 是针对的一个共变函子与一族自然态射来说的, 所以会用这样的一个记号}.
    对$f\in\Hom_k(V,W)$与$v\in V$, 我们有
    \(\iota_W\circ f(v):W^*\to k\)
    \begin{align*}
        w^*&\mapsto w^*(f(v))\\
        &=(f^*(w^*))(v)
    \end{align*}
    以及
    \(f^{**}\circ\iota_V(v):W^*\to k\)
    \begin{align*}
        w^*&\mapsto(\iota_V(v)\circ f^*)(w^*)\\
        &=\iota_V(v)(f^*(w^*))\\
        &=f^*(w^*)(v)
    \end{align*}
    因此图表~\eqref{naturality of double dual}~交换.
    综上可知$V$与$V^{**}$自然同构.
\end{proof}

\section{自由模与张量积}
我们在这一节描述我们要用到的最重要的代数工具: 张量积.
第一小节\textit{自由模}会提供证明张量积存在所需要的工具, 并让我们熟悉\textit{泛性质}的语言与相应的证明手法.
在第二小节\textit{张量积}中, 我们会模仿前一小节使用的语言与证明, 通过泛性质给出张量积的定义与基本性质.
我们还会讨论张量积与向量空间有关的性质.
本节中的$R$是一个交换环, $k$是一个域.

\subsection*{自由模}
\begin{defn}
    一个集合$X$上的\textbf{自由$R$-模}是一个$R$-模$FX$与嵌入映射$\iota:X\to FX$, 满足如下泛性质:
    对任意$R$-模$M$与映射$f:X\to M$, 均存在唯一的$R$-同态$\overline{f}$使得以下图表交换:
    \[\begin{tikzcd}[row sep=large]
        FX \arrow[dr, dashed, "\overline{f}"]\\
        X \arrow[u, "\iota"] \arrow[r, "f"'] & M
    \end{tikzcd}\]
    $X$也称为$FX$的\textbf{基}.
\end{defn}

在证明自由模的存在性之前, 我们先说明自由模的唯一性.
\begin{prop}\label{uniqueness of free module}
    如果$X$上的自由$R$-模存在, 那么它在同构意义下是唯一的.
\end{prop}
\begin{proof}
    假设$(A,\iota_A),(B,\iota_B)$是$X$上的两个自由模, 按照泛性质, 我们可以画出如下交换图:
    \begin{equation*}
        \begin{tikzcd}[sep=large]
            A \arrow[rr, "1_A"] \arrow[dr, dashed, "\overline{\iota_B}"] & & A\\
            & B \arrow[ur, dashed, "\overline{\iota_A}"] &\\
            & X \arrow[uul, "\iota_A"] \arrow[u, "\iota_B"] \arrow[uur, "\iota_A"'] &
        \end{tikzcd}
    \end{equation*}
    由泛性质, 存在$R$-同态$\overline{\iota_A},\overline{\iota_B}$使得左右的两个小三角形交换.
    而上方小三角形的交换性结合唯一性可以给出$\overline{\iota_A}\circ\overline{\iota_B}=1_A$.
    同理$\overline{\iota_B}\circ\overline{\iota_A}=1_B$, 那么$\overline{\iota_A},\overline{\iota_B}$是同构映射, 从而$A$与$B$同构.
\end{proof}

我们接下来证明自由模存在.
为此, 我们先回忆一下\textit{外直和}的概念.
\begin{defn}
    设$\{M_\alpha\}_{\alpha\in A}$是一族$R$-模, 它们的\textbf{外直和}定义为
    \[\bigoplus_{\alpha\in A}M_\alpha:=\left\{\left.m\in\prod_{\alpha\in A}M_\alpha\right|\ m\text{仅有有限个坐标非}0\right\}\]
\end{defn}

外直和有一个简单的泛性质:
\begin{prop}\label{direct limit}
    设$\{M_\alpha\}_{\alpha\in A}$是一族$R$-模, $\displaystyle\iota_\beta:M_\beta\to\bigoplus_{\alpha\in A}M_\alpha$为自然嵌入映射,
    即将$m\in M_\beta$映为$\displaystyle\bigoplus_{\alpha\in A}M_\alpha$中$\beta$分量为$m$的元素.
    设$N$是一个$R$-模, 那么对任意一族同态$\{f_\alpha:M_\alpha\to N\}_{\alpha\in A}$, 均存在唯一一个同态满足
    \begin{align*}
        f:\bigoplus_{\alpha\in A}M_\alpha&\to N\\
        \forall\alpha\in A:\ f\circ\iota_\alpha&=f_\alpha
    \end{align*}
\end{prop}
\begin{proof}
    对$\displaystyle m=\sum_{m_i\in M_i}r_im_i$ (注意到这是一个有限和), 直接定义
    \[f(m)=\sum_{m_i\in M_i}r_if_i(m_i)\]
    容易验证$f$满足要求.
    如果还有另一个同态$g$满足条件, 那么有
    \begin{align*}
        g\left(\sum_{m_i\in M_i}r_im_i\right)&=\sum_{m_i\in M_i}r_ig(m_i)\\
        &=\sum_{m_i\in M_i}r_i(g\circ\iota_i)(m_i)\\
        &=\sum_{m_i\in M_i}r_if_i(m_i)\\
        &=f\left(\sum_{m_i\in M_i}r_im_i\right)
    \end{align*}
    从而$g=f$, 这个同态是唯一的.
\end{proof}

外直和也可以从这个泛性质出发来定义, 证明唯一性等等.

以下证明任意集合$X$上的自由模存在.
\begin{proof}
    记号承命题~\ref{direct limit}.
    我们用$X$为$R$加上指标, 得到一族$R$-模 (每一个都是$R$的一份复制), 考虑它们的外直和
    \[FX=\bigoplus_{x\in X}R_x\]
    并定义嵌入映射$\iota:x\mapsto\iota_x(1)$.
    我们定义每个$R_x$到$M$的同态$f_x(r)=rf(x)$, 那么由命题~\ref{direct limit}~可知存在唯一的$\overline{f}$满足对任意$x$都有$\overline{f}\circ\iota_x=f_x$.
    断言$\overline{f}$就是所求的同态, 那么我们需要验证交换性. 对任意$x\in X$都有
    \begin{align*}
        (\overline{f}\circ\iota)(x)&=(\overline{f}\circ\iota_x)(1)\\
        &=f_x(1)\\
        &=1f(x)=f(x)
    \end{align*}
    所以$\overline{f}\circ\iota=f$, 命题得证.
\end{proof}

\begin{eg}
    \begin{enumerate}[(1)]
        \item 设$\mathcal{B}$是向量空间$V$的一组基, 那么$V$就是$\mathcal{B}$上的自由$k$-模.
        于是$V$由$\mathcal{B}$的基数决定, 即由维度决定.
        从而命题~\ref{uniqueness of free module}~再次给出了``向量空间同构当且仅当他们维度相等''这个命题的证明.
        \item 考察以下交换图:
        \[\begin{tikzcd}
            FX \arrow[rr, bend left, "F(g\circ f)"] \arrow[r, "Ff"] & FY \arrow[r, "Fg"] & FZ\\
            X \arrow[u, "\iota_X"] \arrow[r, "f"] \arrow[rr,bend right, "g\circ f"'] & Y \arrow[u, "\iota_Y"] \arrow[r, "g"] & Z \arrow[u, "\iota_Z"]
        \end{tikzcd}\]
        通过对每个矩形应用泛性质, 我们可以知道基$X,Y$之间的映射$f$可以决定自由模之间的同态$Ff:FX\to FY$.
        同时, 上方的小三角形说明基决定的同态满足$F(g\circ f)=Fg\circ Ff$.
        这些在线性代数中熟知 (但不一定这样陈述) 的事实有一个高大上的名字叫做\textit{自由的函子性}.
        \item 按照自由模存在性的证明中同态的构造, 有限维自由模之间的同态也可以使用矩阵来表示, 并通过左乘列向量 (或现在少有人用的右乘行向量) 来进行作用.
    \end{enumerate}
\end{eg}

\subsection*{张量积}
我们也用泛性质来定义张量积.
首先回忆映射$f:A\times B\to C$满足\textit{$R$-双线性}指的是对任意$a,u\in A,\ b,v\in B$与$r\in R$有
\begin{gather*}
    f(a+u,b)=f(a,b)+f(u,b)\\
    f(a,b+v)=f(a,b)+f(a,v)\\
    f(ra,b)=rf(a,b)=f(a,rb)
\end{gather*}

\begin{defn}
    $R$-模$M,N$的\textbf{张量积}是一个$R$-模$T$与自然$R$-双线性映射$h:M\times N\to T$, 满足如下泛性质:
    对任意$R$-模$E$与双线性映射$f:M\times N\to E$, 存在唯一的$\overline{f}\in\Hom_R(T,E)$使得以下图表交换
    \[\begin{tikzcd}[row sep=large]
        T \arrow[rd, dashed, "\widetilde{f}"] & \\
        M\times N\arrow[r, "f"'] \arrow[u, "h"] & E
    \end{tikzcd}\]
\end{defn}

类似命题~\ref{uniqueness of free module}~也有

\begin{prop}\label{uniqueness of tensor product}
    如果$R$-模$M,N$的张量积存在, 那么它在同构意义下唯一, 记为$M\otimes_R N$.
\end{prop}
\begin{proof}
    证明是一模一样的, 如果$M,N$有两个张量积$A,B$, 考察以下交换图
    \[\begin{tikzcd}[row sep=large]
        A \arrow[rr, "1_A"] \arrow[dr, dashed, "\overline{h_B}"] & & A\\
        & B \arrow[ur, dashed, "\overline{h_A}"] &\\
        & M\times N \arrow[uul, "h_A"] \arrow[u, "h_B"] \arrow[uur, "h_A"'] &
    \end{tikzcd}\]
    可以知道$\overline{h_A}\circ\overline{h_B}=1_A$, 同理也有$\overline{h_B}\circ\overline{h_A}=1_B$, 因此$A$和$B$是同构的.
\end{proof}

\begin{sym}
    \begin{enumerate}[(1)]
        \item 大部分时候, 如果环是确定的, 我们不会在$\otimes$下写下标.
        \item 对$m\in M,n\in N$, 我们记$h(m,n):=m\otimes n$.
    \end{enumerate}
\end{sym}

我们接下来着手证明张量积的存在性.

\begin{proof}
    设$(F,\iota)$是$M\times N$上的自由模, 又设$S$是$F$中所有形如
    \begin{gather*}
        (a+c,b)-(a,b)-(c,b)\\
        (a,b+c)-(a,b)-(a,c)\\
        (ra,b)-r(a,b)\\
        (a,rb)-r(a,b)
    \end{gather*}
    的元素生成的子模.
    考虑$F/S$, 设自然同态$\pi:F\to F/S$.
    取自然映射$h=\pi\circ\iota$, 由$S$的定义立刻可以知道$h$是双线性的.
    对于一个模$E$与双线性映射$f:M\times N\to E$, 考虑以下交换图:
    \[\begin{tikzcd}[row sep=large]
        M\times N \arrow[dr, "\iota"] \arrow[ddr, "f"'] \arrow[rr, "h"] &  & F/S \arrow[ddl, dashed, "\widetilde{f}"]\\
        & F \arrow[ur, "\pi"] \arrow[d, dashed, "\overline{f}"] & \\
        & E &
    \end{tikzcd}\]
    自由模的泛性质保证了存在唯一的$\overline{f}:F\to E$使得左边的小三角形交换.
    由于$f$是双线性的, 对任意$a,b,c$一定有
    \begin{align*}
        \overline{f}((a+c,b)-(a,b)-(c,b))&=\overline{f}((a+c,b))-\overline{f}((a,b))-\overline{f}((c,b))\\
        &=\overline{f}(\iota(a+c,b))-\overline{f}(\iota(a,b))-\overline{f}(\iota(c,b))\\
        &=f(a+c,b)-f(a,b)-f(c,b)\\
        &=0
    \end{align*}
    同理也有
    \begin{gather*}
        \overline{f}((a,b+c)-(a,b)-(a,c))=0\\
        \overline{f}((ra,b)-r(a,b))=0\\
        \overline{f}((a,rb)-r(a,b))=0
    \end{gather*}
    因此一定有$S\subset\ker{\overline{f}}$.
    那么由商模的泛性质 (命题~\ref{quotient module}), 存在唯一的$\widetilde{f}:F/S\to E$使得右边的小三角形交换.
    于是我们完成了整个证明.
\end{proof}

\begin{eg}\label{eg of tensor product}
    \begin{enumerate}
        \item 对任意$R$-模, 都有$M\otimes R\cong M$.
        这只需要注意到我们可以取一个双线性的$h(m,r)=rm$, 并且对所有双线性的$f:M\times R\to N$, 取一个同态$\widetilde{f}(m)=f(m,1)$,
        这样就有
        \[f(m,r)=f(rm,1)=\widetilde{f}(rm)=(\widetilde{f}\circ h)(m,r)\]
        满足泛性质. 那么由唯一性就有$M\otimes R\cong M$.
        \item 张量积的行为可以十分诡异, 比如对Abel群 ($\mathbb{Z}$-模) $\mathbb{Z}/n\mathbb{Z}$与$\mathbb{Q}$, 考虑它们的自然映射:
        \begin{align*}
            h(a,b)&=h\left(na,\frac{b}{n}\right)\\
            &=h\left(0,\frac{b}{n}\right)\\
            &=0
        \end{align*}
        对任意$(a,b)\in\mathbb{Z}/n\mathbb{Z}\times\mathbb{Q}$成立, 所以有$\mathbb{Z}/n\mathbb{Z}\otimes\mathbb{Q}=0$.
        两个非平凡的模的张量积可以是平凡模.
    \end{enumerate}
\end{eg}

除了对模本身做张量积, 模的同态之间也可以做张量积.
\begin{lem}\label{tensor of map}
    对模$M,N,A,B$与同态$f:M\to A,g:N\to B$, 存在唯一的同态$f\otimes g$使得以下图表交换
    \[\begin{tikzcd}[row sep=large]
        M\times N \arrow[r, "f\times g"] \arrow[d, "h_1"] & A\times B \arrow[d, "h_2"]\\
        M\otimes N \arrow[r, "f\otimes g"] & A\otimes B
    \end{tikzcd}\]
    并且$f\otimes g$由
    \[a\otimes b\mapsto f(a)\otimes g(b)\]
    线性延拓给出.
\end{lem}
\begin{proof}
    由于$h_2\circ(f\times g)$是双线性的, 泛性质保证了$f\otimes g$的存在.
    $(f\otimes g)(a\otimes b)=f(a)\otimes g(b)$容易由交换性验证.
\end{proof}

张量积的出现提供了一种模之间的``乘法'', 我们接下来讨论一些张量积简单的类似于乘法的性质.

\begin{prop}[交换律]
    对模$A,B$有$A\otimes B\cong B\otimes A$成立, 其中同构映射由
    \[a\otimes b\mapsto b\otimes a\]
    线性延拓给出.
\end{prop}
\begin{proof}
    设双线性映射
    \begin{gather*}
        h:A\times B\to A\otimes B,\ (a,b)\mapsto a\otimes b\\
        k:A\times B\to B\otimes A,\ (a,b)\mapsto b\otimes a
    \end{gather*}
    以及$R$-同态
    \begin{gather*}
        f:A\otimes B\to B\otimes A,\ a\otimes b\mapsto b\otimes a\\
        g:B\otimes A\to A\otimes B,\ b\otimes a\mapsto a\otimes b
    \end{gather*}
    由线性延拓给出.
    那么考察我们熟悉的交换图
    \[\begin{tikzcd}[row sep=large]
        A\otimes B\arrow[rr, "1_{A\otimes B}"] \arrow[dr, "f"] & & A\otimes B\\
        & B\otimes A \arrow[ur, "g"] &\\
        & A\times B \arrow[uul, "h"] \arrow[u, "k"] \arrow[uur, "h"']
    \end{tikzcd}\]
    就可以得到结论.
\end{proof}

\begin{prop}[结合律]
    对模$A,B,C$有$A\otimes(B\otimes C)\cong(A\otimes B)\otimes C$, 其中同构映射由
    \[a\otimes(b\otimes c)\mapsto (a\otimes b)\otimes c\]
    线性延拓给出.
\end{prop}
\begin{proof}
    考虑由泛性质
    \[\begin{tikzcd}[row sep=large]
        U[A,B,C] \arrow[dr, dashed, "\widetilde{f}"] & \\
        A\times B\times C \arrow[u, "h"] \arrow[r, "f"] & M 
    \end{tikzcd}\]
    决定的模$U[A,B,C]$, 其中$h$是一个三重线性映射 (定义类似双线性映射), 且对任意三重线性映射$f$均存在一个同态$\widetilde{f}$使得上图交换.
    类似两个模的张量积存在的证明, 可以证明$U[A,B,C]$存在且在同构意义下唯一.
    我们证明$A\otimes(B\otimes C)$也满足如上泛性质.
    设以下张量积的自然映射为
    \begin{gather*}
        h_1:A\times(B\otimes C)\to A\otimes(B\otimes C)\\
        h_2:B\times C\to B\otimes C
    \end{gather*}
    给定三重线性映射$f:A\times B\times C\to M$.
    对任意$a\in A$, 映射
    \begin{align*}
        f_a:B\times C&\to M\\
        (b,c)&\mapsto f(a,b,c)
    \end{align*}
    关于$b,c$是双线性的, 因此由$B\otimes C$的泛性质, 存在唯一的$\widetilde{f_a}:B\otimes C\to M$满足$f_a=\widetilde{f_a}\circ h_2$.
    再定义一个双线性映射
    \begin{align*}
        \overline{f}:A\times(B\otimes C)&\to M\\
        (a,p)&\mapsto \widetilde{f_a}(p)
    \end{align*}
    我们验证它是双线性的.
    由于$\widetilde{f_a}$是同态, 所以$\overline{f}$的第二个分量是线性的.
    而设$\displaystyle p=\sum_{i}r_ib_i\otimes c_i$ (可以这么假设是因为张量积是一个自由模的商), 则有
    \begin{align*}
        \overline{f}(a,p)&=\widetilde{f_a}\left(\sum_{i}r_ib_i\otimes c_i\right)\\
        &=\sum_ir_i\widetilde{f_a}(b_i\otimes c_i)\\
        &=\sum_ir_if_a(b_i,c_i)\quad (f_a=\widetilde{f_a}\circ h_2)\\
        &=\sum_ir_if(a,b_i,c_i)
    \end{align*}
    由于$f$是三重线性的, 那么由上式可知$\overline{f}$对第一个分量也是线性的.
    那么由$A\otimes(B\otimes C)$的泛性质, 存在唯一的$\widetilde{f}$满足$\overline{f}=\widetilde{f}\circ h_1$.
    取$h=h_1\circ(1_A\times h_2):A\times B\times C\to A\otimes(B\otimes C)$, 那么容易验证$h$是三重线性的, 并且有
    \begin{align*}
        \widetilde{f}\circ h&=\widetilde{f}\circ h_1\circ(1_A\times h_2)\\
        &=\overline{f}\circ(1_A\times h_2)
    \end{align*}
    同时又有
    \begin{align*}
        \overline{f}\circ(1_A\times h_2)(a,b,c)&=\overline{f}(a,h_2(b,c))\\
        &=\widetilde{f_a}\circ h_2(b,c)\\
        &=f_a(b,c)\\
        &=f(a,b,c)
    \end{align*}
    所以有$\widetilde{f}\circ h=f$, 因此$A\otimes(B\otimes C)$满足泛性质.
    同理可证$(A\otimes B)\otimes C$也满足泛性质, 所以它们一定同构.
    容易验证$a\otimes(b\otimes c)\mapsto (a\otimes b)\otimes c$给出了同构映射.
\end{proof}

\begin{prop}[分配律]\label{distribution}
    对模$A$与一族模$\{B_i\}_{i\in I}$, 有如下同构成立:
    \[A\otimes\left(\bigoplus_{i\in I}B_i\right)\cong\bigoplus_{i\in I}(A\otimes B_i)\]
    同构映射由
    \[a\otimes(b_i)\mapsto(a\otimes b_i)\]
    线性延拓给出.
\end{prop}
\begin{proof}
    设$\{B_i\}_{i\in I}$的嵌入映射为$\{\iota_i\}_{i\in I}$, $\{A\otimes B_i\}_{i\in I}$的嵌入映射为$\{\iota^\otimes_i\}_{i\in I}$.
    对于任意$i\in I$, 考虑以下图表:
    \[\begin{tikzcd}[column sep=small]
        A\times B_i \arrow[dd, "1_A\times\iota_i"'] \arrow[dr, "f_i"] \arrow[rr, "h_i"] & &
        A\otimes B_i \arrow[dl, dashed, "\widetilde{f_i}"'] \arrow[dd, "\iota^\otimes_i"] \\
        & M & \\
        A\times(\bigoplus_{i\in I}B_i) \arrow[ur, "f"] \arrow[rr, dashed, "h"] & &
        \bigoplus_{i\in I}(A\otimes B_i) \arrow[ul, dashed, "\widetilde{f}"']
    \end{tikzcd}\]
    $f_i=f\circ(1_A\times\iota_i)$是一个双线性映射, $h_i$是$A\otimes B_i$的自然双线性映射.
    那么由$A\otimes B_i$的泛性质, 存在唯一的同态$\widetilde{f_i}:A\otimes B_i\to M$使得上方的三角形交换.
    又由外直和的泛性质 (命题~\ref{direct limit}), 存在唯一的$\displaystyle f:\bigoplus_{i\in I}(A\otimes B_i)\to M$使得每张图中右侧的三角形交换.
    定义
    \begin{align*}
        h:A\otimes\left(\bigoplus_{i\in I}B_i\right)&\to\bigoplus_{i\in I}(A\otimes B_i)\\
        \left(a,\sum_{b_i\in B_i}r_ib_i\right)&\mapsto\sum_{b_i\in B_i}r_ia\otimes b_i
    \end{align*}
    那么$h$自然是双线性的.
    以下验证泛性质:
    \begin{align*}
        (\widetilde{f}\circ h)\left(a,\sum_{b_i\in B_i}r_ib_i\right)&=\widetilde{f}\left(a,\sum_{b_i\in B_i}r_ib_i\right)\\
        &=\sum_{b_i\in B_i}r_i(\widetilde{f}\circ\iota_i^\otimes)(a\otimes b_i)\\
        &=\sum_{b_i\in B_i}r_if_i(a\otimes b_i)\\
        &=\sum_{b_i\in B_i}r_if(a,b_i)\\
        &=f\left(a,\sum_{b_i\in B_i}r_ib_i\right)
    \end{align*}
    所以有
    \[A\otimes\left(\bigoplus_{i\in I}B_i\right)\cong\bigoplus_{i\in I}(A\otimes B_i)\]
    容易验证$a\otimes(b_i)\mapsto(a\otimes b_i)$给出了同构映射.
\end{proof}

当我们的目光转向有限维向量空间时, 分配律会给我们一些很强的结论.

\begin{prop}
    设$V,W$是向量空间, 那么有$\dim{V\otimes W}=\dim{V}\dim{W}$.
\end{prop}
\begin{proof}
    用自然数为域$k$加上指标, 可以得到一族$k$-向量空间, 其中每一个都是$k$自身的一个复制.
    设$\dim V=m,\dim W=n$, 那么有$V\cong k^m,W\cong k^n$, 则$V\otimes W\cong k^m\otimes k^n$, 且有
    \begin{align*}
        k^m\otimes k^n&=\left(\bigoplus_{i=1}^mk_i\right)\otimes\left(\bigoplus_{j=1}^nk_j\right)\\
        &\cong\bigoplus_{1\leq i\leq m,1\leq j\leq n}k_i\otimes k_j\quad\text{(分配律)}\\
        &\cong\bigoplus_{1\leq i\leq mn}k_i\quad\text{(例~\ref{eg of tensor product})}\\
        &=k^{mn}
    \end{align*}
    所以$V\otimes W\cong k^{mn}$, 因此是$mn$维的.
\end{proof}

这件事情还可以由另一种方式得到:
\begin{prop}
    设$V,W$是向量空间, 分别以$\{e_1,\cdots,e_m\}$与$\{g_1,\cdots,g_n\}$为一组基, 那么$\mathcal{B}:=\{e_i\otimes g_j|1\leq i\leq m,1\leq j\leq n\}$是$V\otimes W$的一组基.
    从而可以推出$V,W$是$mn$维的.
\end{prop}
\begin{proof}
    向量空间就是域上的自由模, 我们尝试通过处理泛性质来证明这个命题.
    设$\iota:\mathcal{B}\to V\otimes W$是嵌入映射.
    对任意的$k$-向量空间$A$, 给定映射$f:\mathcal{B}\to A$, 我们定义一个双线性映射
    \begin{align*}
        \overline{f}:V\times W&\to A\\
        (e_i,g_j)&\mapsto f(e_i\otimes g_j)
    \end{align*}
    由于双线性映射被其在两组基的Descartes积上的取值唯一确定, 所以上述定义是良好的.
    我们考察以下图表
    \[\begin{tikzcd}[row sep=large]
        \mathcal{B}\arrow[r, "\iota"] \arrow[dr, "f"'] &
        V\otimes W \arrow[d, dashed, "\widetilde{f}"] &
        V\times W \arrow[l, "h"'] \arrow[dl, "\overline{f}"]\\
        & A &
    \end{tikzcd}\]
    由$V\otimes W$的泛性质, 存在唯一的同态$\widetilde{f}$使得右侧小三角形交换.
    而对左侧小三角形, 我们有
    \begin{align*}
        (\widetilde{f}\circ\iota)(e_i\otimes g_j)&=\widetilde{f}(e_i\otimes g_j)\\
        &=(\widetilde{f}\circ h)(e_i,g_j)\\
        &=\overline{f}(e_i,g_j)\\
        &=f(e_i\otimes g_j)
    \end{align*}
    从而左侧小三角形交换, $(V\otimes W,\iota)$满足自由模的泛性质.
    所以$\mathcal{B}$是$V\otimes W$的一组基.
\end{proof}

接下来我们让对偶空间加入讨论. 以下我们默认$V=V^{**}$, 即将有限维向量空间的双重对偶视为与自身是等同的.
同时, 我们还假设所有向量空间都是有限维的.
一个小小的引理是对偶关于张量积``分配''.
\begin{lem}
    设$V,W$是向量空间, 那么$(V\otimes W)^*$与$V^*\otimes W^*$自然同构, 即同构映射不依赖于基的选取.
\end{lem}
\begin{proof}
    设$V,W$分别有基$\{v_i\}_{1\leq i\leq m}$与$\{w_i\}_{1\leq i\leq n}$, 这两组基给出它们到各自对偶空间的同构$d^V_1:V\to V^*$, $d^W_1:W\to W^*$与$d_1:V\otimes W\to (V\otimes W)^*$.
    设它们各自的另一组基为$\{e_i\}_{1\leq i\leq m}$, $\{g_i\}_{1\leq i\leq n}$, 及同构$d^V_2:V\to V^*$, $d^W_2:W\to W^*$与$d_2:V\otimes W\to(V\otimes W)^*$.
    考虑图表
    \begin{equation}
        \begin{tikzcd}[column sep=0]
            V^*\times W^* \arrow[rr, "d^V_1\times d^W_1"] \arrow[dd, "d^V_2\times d^W_2"'] \arrow[dr, "h_1"] & &
            V\times W \arrow[dd, "d_1\circ h_2"]\\
            & V^*\otimes W^* \arrow[dr, dashed, "f"] &\\
            V\times W \arrow[rr, "d_2\circ h_2"] & & (V\otimes W)^*
        \end{tikzcd}\label{comudiag for v*w*=(vw)*}
    \end{equation}
    我们想要证明大矩形是交换的.
    为此, 设$p_1=d_1\circ h_2\circ(d_1^V\times d_1^W)$, $p_2=d_2\circ h_2\circ(d_2^V\times d_2^W)$.
    任取$V,W$中的两个元素, 利用双线性性计算有
    \begin{align*}
        p_1\left(\sum_{i=1}^ma^iv_i,\sum_{j=1}^nb^jw_j\right)=\sum_{i,j}a^ib^j(v_i\otimes w_j)^*
    \end{align*}
    设基变换
    \begin{gather*}
        v_i=\sum_{k=1}^mx^k_ie_k\quad i=1,2,\cdots,m\\
        w_i=\sum_{l=1}^ny^l_ig_l\quad i=1,2,\cdots,n
    \end{gather*}
    那么有
    \begin{equation}
        \left(\sum_{i=1}^ma^iv_i,\sum_{j=1}^nb^jw_j\right)=\left(\sum_{i,k}a^ix^k_ie_k,\sum_{j,l}b^jy^l_jg_l\right)\label{tensor for 2 basis}
    \end{equation}
    且有
    \begin{align*}
        \sum_{i,j}a^ib^j(v_i\otimes w_j)^*&=\sum_{i,j}a^ib^j\left(\sum_{k}x^k_ie_k\otimes\sum_{l}y^l_jg_l\right)^*\\
        &=\sum_{i,j,k,l}a^ib^jx^k_iy^l_j(e_k\otimes g_l)^*
    \end{align*}
    以及
    \begin{align*}
        p_2\left(\sum_{i=1}^ma^iv_i,\sum_{j=1}^nb^jw_j\right)&=\left(\sum_{i,k}a^ix^k_ie_k\otimes\sum_{j,l}b^jy^l_jg_l\right)^*\quad\text{(由式~\eqref{tensor for 2 basis})}\\
        &=\sum_{i,j,k,l}a^ib^jx^k_iy^l_j(e_k\otimes g_l)^*
    \end{align*}
    所以大矩形是交换的.
    那么由张量积的泛性质, 存在唯一的线性映射$f:V^*\otimes W^*\to(V\otimes W)^*$使得整个图交换, 并且注意到$f$不依赖某个特定的基的选取.
    考虑由$v_i^*\otimes w_j^*\mapsto (v_i\otimes w_j)^*$线性延拓得到的映射$f'$, $f'$将$V^*\otimes W^*$的一组基映为$(V\otimes W)^*$的一组基, 从而是一个同构.
    又注意到$f'$显然可以作为虚线处的映射使得图~\eqref{comudiag for v*w*=(vw)*}~交换, 所以有$f=f'$.
    因此$f$是同构, 并且我们前面证明了它不依赖于基的选取.
    所以$V^*\otimes W^*$与$(V\otimes W)^*$自然同构.
\end{proof}

这是我们第一次用张量的分量进行计算.

关于对偶空间有两个基础的性质:
\begin{prop}\label{linear and tensor}
    对向量空间$V,W$, 有自然同构$V^*\otimes W\cong\Hom(V,W)$.
\end{prop}
\begin{proof}
    设$h:V^*\times W\to V^*\otimes W$是自然映射.
    定义一个双线性映射
    \begin{align*}
        f:V^*\times W&\to\Hom(V,W)\\
        f(v^*,w):a&\mapsto v^*(a)w
    \end{align*}
    由泛性质, 存在一个线性映射$\widetilde{f}:V^*\otimes W\to\Hom(V,W)$使得$f=\widetilde{f}\circ h$.
    我们给出$\widetilde{f}$的逆映射$g$.
    任取$V,W$的基$\{v_i\}_{1\leq i\leq m}$与$\{w_i\}_{1\leq i\leq n}$, 如果$\sigma\in\Hom(V,W)$满足
    \[\sigma(v_i)=\sum_{j}=a_{ji}w_j,\quad i=1,2,\cdots,m\]
    那么定义$\displaystyle g(\sigma)=\sum_{i,j}a_{ji}v_i\otimes w_j$.
    注意到
    \begin{align*}
        (\widetilde{f}\circ g)(\sigma)&=\widetilde{f}\left(\sum_{i,j}a_{ji}v_i\otimes w_j\right)\\
        &=\sum_{i,j}a_{ji}\widetilde{f}(v_i\otimes w_j)\\
        &=\sum_{i,j}a_{ji}f(v_i^*,w_j)\\
        &=\sum_{i,j}a_{ji}v_i^*(\quad)w_j
    \end{align*}
    注意到$\displaystyle\sum_{i,j}a_{ji}v_i^*(\quad)w_j$在基$\{v_i\}_{1\leq i\leq m}$上取值与$\sigma$相同, 所以它与$\sigma$相等.
    因此$\widetilde{f}\circ g=1_{\Hom(V,W)}$, 所以$\widetilde{f}$是同构\footnote{想想为什么不需要验证$g\circ\widetilde{f}=1_{V^*\otimes W}$?}.
    由于基是任取的, 所以同构一定是自然的.
\end{proof}

\begin{prop}\label{bilinear and tensor}
    设$B(U,V;W)$是全体$U\times V\to W$双线性映射的向量空间, 那么有自然同构$B(U,V;W)\cong U^*\otimes V^*\otimes W$.
\end{prop}
\begin{proof}
    由$U\otimes V$的泛性质, $B(U,V;W)$中的双线性映射与$\Hom(U\otimes V,W)$中的线性映射一一对应, 结合命题~\ref{linear and tensor}~有
    \begin{align*}
        B(U,V;W)&\cong\Hom(U\otimes V,W)\\
        &\cong (U\otimes V)^*\otimes W\\
        &\cong U^*\otimes V^*\otimes W\qedhere
    \end{align*}
\end{proof}

\begin{sym}
    对于一个$R$-模, 我们记
    \begin{align*}
        &\bigotimes\nolimits^0 M:=R\\
        &\bigotimes\nolimits^1 M:=M\\
        &\bigotimes\nolimits^n M:=\underbrace{M\otimes_R M\otimes_R\cdots\otimes_R M}_{n\text{次}},\quad n\geq 2
    \end{align*}
    而对于一个$k$-向量空间$V$, 按照交换律与结合律, $V$与它的对偶空间$V^*$的任意有限次张量积总会同构于
    \[\left(\bigotimes\nolimits^r V\right)\otimes\left(\bigotimes\nolimits^s V^*\right)\]
    我们记
    \[\tensor^{r,s}(V):=\left(\bigotimes\nolimits^r V\right)\otimes\left(\bigotimes\nolimits^s V^*\right)\]
    并把$r,s$分别称为\textbf{反变指数}与\textbf{共变指数}.
\end{sym}

实际上, 前面的内容中我们只用到了向量空间的\textit{自由性质}, 所以前面关于有限维向量空间的命题都可以换成关于有限生成自由模的命题.

\begin{rem}
    对任意$n$个模及以它们为定义域的$n$重线性同态, 考虑由泛性质
    \[\begin{tikzcd}[row sep=huge]
        U[M_1,M_2,\cdots,M_n] \arrow[dr, dashed, "\widetilde{f}"] & \\
        M_1\times M_2\times\cdots\times M_n \arrow[r, "f"] \arrow[u, "h"] & N
    \end{tikzcd}\]
    决定的模$U[M_1,M_2,\cdots,M_n]$.
    可以证明$U[M_1,M_2,\cdots,M_n]$存在且自然同构于$M_1\otimes M_2\otimes\cdots\otimes M_n$ (\parencite[命题B-5.17, B-5.18]{Rotman_AdvMdnAlg}).
    那么类似于命题~\ref{bilinear and tensor}, 容易证明所有$r+s$重线性映射$(V^*)^r\times V^s\to k$构成的空间等同于$\tensor^{r,s}(V)$.

    古典意义下的一个\textbf{张量}指的是一个$(V^*)^r\times V^s\to k$的多重线性映射, 也即$\tensor^{r,s}(V)$中的一个元素$v_1\otimes\cdots v_r\otimes v^*_1\otimes\cdots\otimes v^*_s$.
    其中$v_1\otimes\cdots v_r$称为\textbf{反变部分}, $v^*_1\otimes\cdots\otimes v^*_s$称为\textbf{共变部分}.
    $r=0$时的张量称为\textbf{共变张量}, $s=0$时的张量称为\textbf{反变张量}.

    古典的张量是直接使用多重线性映射定义的, 但这样的定义只适用于有限维向量空间.
    因此我们把古典张量理论中的一些名词列举了出来, 方便读者阅读其他资料, 但之后的笔记中我们会为了保持``\textit{代数的纯洁性}''而不怎么使用这些名词.
\end{rem}

\section{张量代数与外代数}
本节为微分形式这一微分几何中的重要工具铺路.
不是很希望了解具体代数构造的读者可以直接阅读第二小节外代数的性质.
\subsection*{张量代数与外代数的构造}
\textit{代数}一词在这里指的是一种建立在模上的代数结构, 虽然容易引起混淆, 但是在学界广泛使用已久, 我们也依例沿用.
代数的等价定义有许多种, 我们这里选取~\parencite{Rotman_AdvMdnAlg}~上的定义.

\begin{defn}
    设$k$是一个交换环, 如果环$R$是一个$k$-模并且对任意$a\in k$, $r,s\in R$都有
    \begin{equation}
        a(rs)=(ar)s=r(as)\label{def of alg}
    \end{equation}
    那么称$R$是一个\textbf{$k$-代数}.
\end{defn}

我们需要用到的一类特殊的代数叫做分次代数.
\begin{defn}
    设$A$是一个环$k$-代数, 如果存在Abel群$A^i,i\in\mathbb{N}$满足
    \begin{enumerate}
        \item $\displaystyle A=\bigoplus_{i\in\mathbb{N}}A^i$;
        \item 对任意$i,j\in\mathbb{N}$及$a_i\in A^i$与$a_j\in A^j$, 有$a_ia_j\in A^{i+j}$, 即
        \[A^iA^j\subset A^{i+j}\]
    \end{enumerate}
    那么称$A$是一个\textbf{分次环}, 并将每个Abel群$G^i$中的元素称为\textbf{齐次元}.
    如果进一步地, $A$是一个$k$-代数, 那么称$A$是一个\textbf{分次$k$-代数}.
\end{defn}

\begin{eg}
    为了不让这一节过于枯燥, 我们举一个最简单的分次代数的例子.
    考虑$k$上的多项式环$k[x]$与多元多项式环$k[x,y,z,\cdots]$, 它们有自然的次数与齐次多项式.
    比如$xy+yz+xz$是齐次的, 但$x+yz$不是.
\end{eg}

\begin{defn}
    设$I$是分次代数$A$的一个双边理想, 如果$I$满足
    \[I=\bigoplus_{i\in N}I^i\]
    其中$I^i=A^i\cap I,i\in\mathbb{N}$, 那么称$I$为$A$的一个\textbf{分次理想}.
\end{defn}

我们只需要两个小引理:
\begin{lem}\label{quotient alg}
    设$A$是分次代数, $I$是它的一个分次理想, 那么$A/I$也是一个分次代数.
\end{lem}
\begin{proof}
    由于$I$是$A$的理想, 所以$A/I$具有环结构.
    而对于任意的$a\in k$与$r+I,s+I\in A/I$, 有
    \begin{align*}
        (a(r+I))(s+I)&=(ar+I)(s+I)\\
        &=(ar)s+I\\
        a((r+I)(s+I))&=a(rs+I)\\
        &=a(rs)+I\\
        (r+I)(a(s+I))&=(r+I)(as+I)\\
        &=r(as)+I
    \end{align*}
    与式~\eqref{def of alg}~比较可知$A/I$构成$k$-代数.
    定义Abel群同态
    \begin{align*}
        f:\bigoplus_{i\in\mathbb{N}}A^i&\to\bigoplus_{i\in\mathbb{N}}(A^i/I^i)\\
        (a_i)&\mapsto(a_i+I_i)
    \end{align*}
    那么显然$f$是满射, 且$\displaystyle\ker f=\bigoplus_{i\in\mathbb{N}}I$.
    因此由第一同构定理可知
    \[\bigoplus_{i\in\mathbb{N}}\frac{A^i}{I^i}\cong\frac{\bigoplus_{i\in\mathbb{N}}A}{\bigoplus_{i\in\mathbb{N}}I}=\frac{A}{I}\]
    综上可知$A/I$是分次$k$-代数.
\end{proof}

\begin{lem}\label{homogeneous ideal}
    设$I$是$A$中的齐次元生成的双边理想, 那么$I$是齐次理想.
\end{lem}
\begin{proof}
    设$I=\langle X\rangle$, $X$中的元素均为齐次元.
    我们只需要说明$\displaystyle I\subset\bigoplus_{i\in\mathbb{N}}(I\cap A^i)$ (另一边包含是自动成立的), 则命题得证.
    对于$I$中任意一个元素, 我们一定可以将它写成
    \[\sum_{x_\mscrl\in X}a_\mscrl x_\mscrl b_\mscrl\quad(a_\mscrl,b_\mscrl\in A)\]
    我们只需要证明每一个$a_\mscrl x_\mscrl b_\mscrl$是$A$中齐次元的和即可.
    去掉下标, 注意到$a$与$b$可以写成齐次元的和, 一定有
    \[axb=\sum_{i,j}a_ixb_j\]
    那么每个$a_ixb_j$都是$A$的齐次元, 并且在$I$中.
    因此$I$中的元素都可以写成$I\cap A^i,\ i\in\mathbb{N}$中元素的和, 从而有$\displaystyle I\subset\bigoplus_{i\in\mathbb{N}}(I\cap A^i)$成立.
\end{proof}

有了这两个引理, 我们正式开始张量代数与外代数的构造.
设$M$是一个$R$-模, 我们记
\[\bigotimes{M}:=\bigoplus_{i\in\mathbb{N}}\bigotimes\nolimits^i M\]
通过定义乘法$\otimes:(a,b)\mapsto a\otimes b$, 容易验证$(\bigotimes M,+,\otimes)$构成一个环 (利用张量积的分配律与交换律即可).
同时我们注意到乘法满足
\[\left(\bigotimes\nolimits^r M\right)\otimes\left(\bigotimes\nolimits^s M\right)\subset\bigotimes\nolimits^{r+s} M\]
所以$\bigotimes M$是一个分次环.

我们还希望$\bigotimes M$构成一个模, 为此我们定义$r\in R$的作用为
\[r(m_1\otimes m_2\otimes\cdots\otimes m_n)=(rm_1)\otimes m_2\otimes\cdots\otimes m_n\]
由多重线性性, 我们可以得到以下一些式子:
\begin{align*}
    r(m_1\otimes m_2\otimes\cdots\otimes m_n)&=(rm_1)\otimes m_2\otimes\cdots\otimes m_n\\
    &=m_1\otimes(rm_2)\otimes\cdots\otimes m_n\\
    &=\cdots\\
    &=m_1\otimes m_2\otimes\cdots\otimes(rm_n)
\end{align*}
于是进一步地, 对任意$x_1\otimes\cdots x_i$与$y_1\otimes\cdots\otimes y_j$有
\begin{align*}
    (r(x_1\otimes\cdots x_i))\otimes(y_1\otimes\cdots\otimes y_j)&=(rx_1)\otimes\cdots\otimes x_i\otimes y_1\otimes\cdots\otimes y_j\\
    &=x_1\otimes\cdots\otimes x_i\otimes((ry_1)\otimes\cdots\otimes y_j)
\end{align*}
这可以推出~\eqref{def of alg}~式.
因此有
\begin{prop}
    $\bigotimes M$构成一个分次$R$-代数, 称为模$M$上的\textbf{张量代数}.
\end{prop}

取$J=\langle m\otimes m|\ m\in M\rangle$为$\bigotimes M$中所有形如$m\otimes m\ (m\in M)$的元素生成的双边理想, 那么由引理~\ref{homogeneous ideal}~可知$J$是齐次理想.
于是由引理~\ref{quotient alg}~可知$A/J$是一个分次$R$-代数.
我们记
\begin{gather*}
    A^i/J:=\bigwedge\nolimits^i M,\quad i\in\mathbb{N}\\
    \bigwedge M:=\bigoplus_{i\in\mathbb{N}}\bigwedge\nolimits^i M
\end{gather*}
从而定义
\begin{defn}
    对$R$-模$M$, 称$\bigwedge M$为$M$上的\textbf{外代数}.
\end{defn}

\begin{sym}
    $\displaystyle\bigwedge M$继承了$\displaystyle\bigotimes M$的乘法$\otimes:\displaystyle\bigotimes M\times\bigotimes M\to\bigotimes M$, 我们把这个乘法记作$\wedge$, 称为\textbf{楔积}.
    那么按照这个记号, 我们也把陪集$m_1\otimes m_2\otimes\cdots\otimes m_n+J$记为$m_1\wedge m_2\wedge\cdots\wedge m_n$.
\end{sym}

\subsection*{外代数的性质}

外代数是一个代数, 自然满足结合律, 分配律等简单性质.
除此之外外代数还满足

\begin{prop}[交错性]\label{alternative}
    \begin{enumerate}[{\rm (1)}]
        \item 对任意$m\in M$有$m\wedge m=0$;
        \item 对任意$m, m'\in M$有$m\wedge m'=-m'\wedge m$.
    \end{enumerate}
\end{prop}
\begin{proof}
    \begin{enumerate}
        \item $m\otimes m\in\ker\pi$.
        \item 由上一条, 我们知道
        \begin{align*}
            0&=(m+m')\wedge(m+m')\\
            &=m\wedge m+m'\wedge m+m\wedge m'+m'\wedge m'\\
            &=m'\wedge m+m\wedge m'
        \end{align*}
        所以$m\wedge m'=-m'\wedge m$
    \end{enumerate}
\end{proof}

这个命题的推广是
\begin{prop}[反交换律]
    设$\displaystyle x\in\bigwedge\nolimits^p,y\in\bigwedge\nolimits^q$, 那么有$x\wedge y=(-1)^{pq}y\wedge x$.
\end{prop}
\begin{proof}这是一个反复交换的过程.
    设$x=x_1\wedge\cdots\wedge x_p,y=y_1\wedge\cdots\wedge y_q$, 则
    \begin{align*}
        x\wedge y&=-x_1\wedge\cdots\wedge y_1\wedge x_p\wedge y_2\wedge\cdots\wedge y_q\quad\text{(命题(\ref{alternative}))}\\
        &=\cdots\\
        &=(-1)^qx_1\wedge\cdots\wedge x_{p-1}\wedge y_1\wedge\cdots\wedge y_q\wedge x_p\quad\text{(交换$q$次)}\\
        &=\cdots\\
        &=(-1)^{2q}x_1\wedge\cdots\wedge y_1\wedge\cdots\wedge y_q\wedge x_{p-1}\wedge x_p\quad\text{(交换$2q$次)}\\
        &=\cdots\\
        &=(-1)^{pq}y_1\wedge\cdots\wedge y_q\wedge x_1\wedge\cdots\wedge x_p\quad\text{(交换$pq$次)}
    \end{align*}
\end{proof}

\begin{col}
    如果$m_1\wedge\cdots m_i\wedge m_j\wedge m_n$中$m_i=m_j$, 那么有$m_1\wedge\cdots m_i\wedge m_j\wedge m_n=0$.
\end{col}
\begin{proof}
    由反交换律, $m_1\wedge\cdots m_i\wedge m_j\wedge m_n$和$m_i\wedge m_j\wedge m_1\wedge\cdots\wedge m_n$最多只差一个符号, 而$m_i\wedge m_j=0$, 所以$m_1\wedge\cdots m_i\wedge m_j\wedge m_n=0$.
\end{proof}

我们接下来讨论外代数使用泛性质的刻画.

\begin{defn}
    设$R$-同态$f:M_1\times\cdots\times M_n\to N$是$n$-重线性的, 如果存在指标$i\neq j$使得$m_i=m_j$可以推出
    \[f(\cdots,m_i,\cdots,m_j,\cdots)=0\]
    那么称$f$是\textbf{交错的}.
    如果对任意$i\neq j$有
    \[f(\cdots,m_i,\cdots,m_j,\cdots)=-f(\cdots,m_j,\cdots,m_i,\cdots)\]
    那么称$f$是\textbf{反对称}的.
\end{defn}

一个有益的练习是, 证明如果在$R$中$2=1+1$是单位的话, 交错与反对称是一回事.

\begin{prop}
    设$M_1,M_2\cdots,M_n,N$是$R$-模, $n$-重线性映射$h$满足
    \begin{align*}
        h:M_1\times M_2\times\cdots\times M_n&\to M_1\wedge M_2\wedge\cdots\wedge M_n\\
        (m_1,m_2,\cdots,m_n)&\mapsto m_1\wedge m_2\wedge\cdots\wedge m_n
    \end{align*}
    那么对任意$n$-重线性同态$f:M_1\times\cdots\times M_n\to N$, 存在唯一的$\widetilde{f}\in\Hom(M_1\wedge M_2\wedge\cdots\wedge M_n,N)$使得以下图表交换
    \begin{equation}
        \begin{tikzcd}[row sep=large]
            M_1\wedge M_2\wedge\cdots\wedge M_n  \arrow[dr, "\widetilde{f}"] & \\
            M_1\times M_2\times\cdots\times M_n \arrow[u, "h"] \arrow[r, "f"'] & N
        \end{tikzcd}\label{comudiag in uniprop of extalg}
    \end{equation}
\end{prop}
\begin{proof}
    考虑以下交换图
    \[\begin{tikzcd}[row sep=large]
        M_1\wedge M_2\wedge\cdots\wedge M_n \arrow[ddr, dashed, bend left=15, "\widetilde{f}"] & \\
        M_1\otimes M_2\otimes\cdots\otimes M_n \arrow[u, "\pi"] \arrow[dr, dashed, "\overline{f}"] & \\
        M_1\times M_2\times\cdots\times M_n \arrow[u, "h'"] \arrow[r, "f"'] & N
    \end{tikzcd}\]
    由张量积的泛性质, 存在唯一的$\overline{f}\in\Hom(M_1\otimes M_2\otimes\cdots\otimes M_n,N)$使得下方的小三角形交换.
    考虑$\ker\pi$, 即$M_1\otimes M_2\otimes\cdots\otimes M_n$中所有形如$m\otimes m\ (m\in M)$的元素生成的双边理想.
    取$\ker\pi$中任意的$\displaystyle x=\sum_{m_i\in M}a_i\otimes m_i\otimes m_i\otimes b_i$, 由交错映射的定义, 一定有
    \begin{align*}
        \overline{f}(x)&=\sum_{m_i\in M}\overline{f}(a_i\otimes m_i\otimes m_i\otimes b_i)\\
        &=\sum_{m_i\in M}f(a_i,m_i,m_i,b_i)\\
        &=0
    \end{align*}
    这里我们轻微地滥用记号, 不区分$a_i,b_i$在$h'$作用下的像和原像.
    因此有$\overline{f}(\ker\pi)=0$, 那么由商模的泛性质可知, 存在唯一的$\widetilde{f}\in\Hom(M_1\wedge M_2\wedge\cdots\wedge M_n,N)$使得上方的小三角形交换.
    注意到$h=\pi\circ h'$, 所以大三角形与交换图~\eqref{comudiag in uniprop of extalg}~等价, 因此命题得证.
\end{proof}

\begin{rem}
    在古典的张量理论中, 人们会用\textit{交错化}的方法构造交错函数, 即对多重线性函数$f$, 定义
    \[(\operatorname{Alt}f)(v_1,\cdots,v_n):=\sum_{\sigma\in S_n}(\operatorname{sgn}{\sigma})f(v_{\sigma(1)},\cdots,v_{\sigma(n)})\]
    并通过定义两个函数的张量积
    \[(f\otimes g)(v_1,\cdots,v_n,v_{n+1},\cdots,v_m)=f(v_1,\cdots,v_n)g(v_{n+1},\cdots,v_m)\]
    与交错函数的楔积
    \[f\wedge g=\frac{(m+n)!}{m!n!}\operatorname{Alt}(f\otimes g)\]
    来构造张量代数与外代数.
    具体的细节参阅~\parencite{Spivak_CalMani}~的第4章或~\parencite{Lee_IntroSmMani}~的第12, 14章.

    我们刚刚证明了外代数也具有泛性质, 因此我们也可以仿照命题~\ref{uniqueness of free module} 来证明某个模上的外代数的唯一性.
    因此按照命题~\ref{bilinear and tensor}~的精神,
    我们可以认为有限维向量空间$V$上所有$n$元交错函数的空间等同于$\displaystyle\bigwedge\nolimits^n V^*$.
    因此按照古典方法构造的外代数和我们定义的外代数是等同的.
    在下一章中, 我们会经常用到这一点的.
\end{rem}
\blank